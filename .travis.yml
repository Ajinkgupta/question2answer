os: linux
dist: trusty

language: php

php:
  - '7.0'
  - '7.1'
  - '7.2'
  - '7.3'
  - '7.4'

notifications:
  email:
    on_success: change
    on_failure: change

before_script:
  # PHP_CodeSniffer
  - curl -L -o phpcs.phar https://github.com/squizlabs/PHP_CodeSniffer/releases/download/3.6.0/phpcs.phar
  # PHPUnit - manually download old version so that it works on PHP 7.0
  - curl -L -o phpunit.phar https://phar.phpunit.de/phpunit-6.phar
  # Basic config required for PHPUnit
  - cp qa-tests/phpunit-qa-config-example.php qa-config.php

script:
  # PHP_CodeSniffer
  - php phpcs.phar --report=emacs --extensions=php --standard=qa-tests/phpcs/ruleset.xml .
  # PHPUnit (exclude database tests)
  - php phpunit.phar --bootstrap qa-tests/autoload.php --exclude-group database qa-tests
